function [x, P] = EKF_correction(P, v, H, R)
% Фильтр Калмана - предсказание 
%   Входные аргументы:
%   P - Матрица ковариации фильтра Калмана
%   v - Вектор измерений
%   H - Матрица измерений
%   R - Матрица ковариации шумов измерений
%
%   Выходные аргументы:
%   x - Вектор состояния фильтра Калмана
%   P - Матрица ковариации фильтра Калмана


% Коррекция
I = eye(size(P, 1));
K = (P * H') / (H * P * H' + R);
P = (I - K * H) * P * (I - K * H)' + K * R * K';
x = K * v;

end