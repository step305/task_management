function q = dcm_to_quat(Cbn)
%  Cbn = quat_dcm(q)
%  Преобразование матрицы направляющих косинусов в кватернион ориентации
%
%   Входные аргументы:
%   Cbn - матрица направляющих косинусов
%
%   Выходные аргументы:
%   q -  кватернион ориентации


q0 = 1 / 2 * (1 + Cbn(1, 1) + Cbn(2, 2) + Cbn(3, 3)) ^ (1 / 2);
q1 = (1 / (4 * q0)) * (Cbn(2, 3) - Cbn(3, 2));
q2 = (1 / (4 * q0)) * (Cbn(3, 1) - Cbn(1, 3));
q3 = (1 / (4 * q0)) * (Cbn(1, 2) - Cbn(2, 1));

q = [q0, q1, q2, q3];

end
